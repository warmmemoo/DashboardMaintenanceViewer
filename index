<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Embedded Apps Script</title>
  <meta name="color-scheme" content="light dark" />
  <style>
    :root{
      --bg:#0b0b0c; --fg:#e8e8ea; --muted:#9aa0a6; --card:#151517; --btn:#2563eb; --btn-fg:#fff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--fg); font:16px/1.5 system-ui,Segoe UI,Roboto,Arial,sans-serif;
      display:flex; min-height:100dvh; flex-direction:column;
    }
    header{
      padding:12px 16px; background:linear-gradient(90deg, #0f172a 0%, #111827 100%);
      border-bottom:1px solid #222; display:flex; align-items:center; gap:10px;
      position:sticky; top:0; z-index:10;
    }
    header h1{font-size:16px; margin:0; font-weight:600}
    .wrap{flex:1; position:relative}
    .frame{
      position:absolute; inset:0; width:100%; height:100%; border:0; background:#111;
    }
    .fallback{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      padding:24px; text-align:center; background:
        radial-gradient(1200px 600px at 50% -200px, rgba(255,255,255,.06), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.03), transparent 30%);
    }
    .card{
      width:min(680px, 92vw); background:var(--card); border:1px solid #2a2a2e; border-radius:16px;
      padding:22px; box-shadow:0 10px 30px rgba(0,0,0,.35);
    }
    .card h2{margin:0 0 6px; font-size:18px}
    .card p{margin:6px 0 14px; color:var(--muted)}
    .btns{display:flex; gap:10px; flex-wrap:wrap; justify-content:center}
    .btn{
      appearance:none; border:0; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:600;
      background:var(--btn); color:var(--btn-fg);
    }
    .btn.ghost{background:#2b2b30; color:#e5e7eb}
    footer{
      padding:10px 14px; color:#8b8f97; font-size:12px; border-top:1px solid #222; background:#0e0e10;
    }
    code{background:#22242b; padding:2px 6px; border-radius:6px}
  </style>
</head>
<body>
  <header>
    <svg width="20" height="20" viewBox="0 0 24 24" fill="#60a5fa" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <path d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2Zm1 15h-2v-2h2Zm0-4h-2V7h2Z"/>
    </svg>
    <h1>Apps Script Embed</h1>
  </header>

  <div class="wrap">
    <!-- üëá ‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå Apps Script ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
    <script>
      const APP_URL = "https://script.google.com/macros/s/AKfycbwgy4b-0AYtb92hS2boVZsV845xiaZHN-NpgAuqO4MCpb7_NNLBhMeOhyVR5REb0Vilgg/exec";
    </script>

    <iframe id="appFrame" class="frame" loading="lazy" referrerpolicy="no-referrer-when-downgrade" allow="clipboard-write; fullscreen" src=""></iframe>

    <!-- Fallback: ‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠ iframe ‡πÇ‡∏î‡∏ô‡∏ö‡∏•‡πá‡∏≠‡∏Å/‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ -->
    <div id="fallback" class="fallback" hidden>
      <div class="card">
        <h2>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ù‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏î‡πâ (‡∏ñ‡∏π‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô iframe)</h2>
        <p>
          ‡∏ö‡∏≤‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á Apps Script ‡∏ö‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤) ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏±‡∏á‡πÉ‡∏ô‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢
          <code>X-Frame-Options</code>. ‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á URL ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
        </p>
        <div class="btns">
          <button class="btn" id="openNew">‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà</button>
          <button class="btn ghost" id="retry">‡∏•‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà</button>
          <button class="btn ghost" id="redirect">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á (‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ)</button>
        </div>
      </div>
    </div>
  </div>

  <footer>
    ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ù‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Ñ‡∏ß‡∏£ Deploy ‡πÄ‡∏õ‡πá‡∏ô Web app ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ‚ÄúWho has access‚Äù ‡πÄ‡∏õ‡πá‡∏ô ‚ÄúAnyone‚Äù (‡∏´‡∏£‡∏∑‡∏≠ ‚ÄúAnyone with the link‚Äù)
    ‡πÅ‡∏•‡∏∞‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏ì‡∏µ‡∏≠‡∏≤‡∏à‡∏¢‡∏±‡∏á‡∏ñ‡∏π‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÇ‡∏î‡∏¢ <code>X-Frame-Options</code> ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå
  </footer>

  <script>
    const iframe = document.getElementById('appFrame');
    const fallback = document.getElementById('fallback');
    const openNew = document.getElementById('openNew');
    const retry = document.getElementById('retry');
    const redirect = document.getElementById('redirect');

    // ‡∏ï‡∏±‡πâ‡∏á src ‡∏Ç‡∏≠‡∏á iframe
    iframe.src = APP_URL;

    // ‡∏ñ‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏Å‡∏¥‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á fallback (‡∏Å‡∏±‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡πÇ‡∏î‡∏ô X-Frame-Options ‡∏ö‡∏•‡πá‡∏≠‡∏Å)
    let loaded = false;

    // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÄ‡∏£‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ç‡πâ‡∏≤‡∏° origin ‡∏ï‡∏£‡∏á ‡πÜ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡πÉ‡∏ä‡πâ timeout ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏ö‡∏≠‡∏Å‡∏ó‡∏≤‡∏á‡∏≠‡πâ‡∏≠‡∏°
    const watchdog = setTimeout(() => {
      if (!loaded) fallback.hidden = false;
    }, 2200);

    // onload ‡∏à‡∏∞‡∏¢‡∏¥‡∏á‡πÅ‡∏°‡πâ‡πÄ‡∏õ‡πá‡∏ô cross-origin ‡∏ñ‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
    iframe.addEventListener('load', () => {
      loaded = true;
      clearTimeout(watchdog);
      // ‡∏ã‡πà‡∏≠‡∏ô fallback ‡∏´‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏¢‡πÇ‡∏ä‡∏ß‡πå‡πÅ‡∏•‡πâ‡∏ß
      fallback.hidden = true;
    });

    openNew.addEventListener('click', () => {
      window.open(APP_URL, '_blank', 'noopener,noreferrer');
    });

    retry.addEventListener('click', () => {
      fallback.hidden = true;
      loaded = false;
      iframe.src = APP_URL + (APP_URL.includes('?') ? '&' : '?') + 'ts=' + Date.now();
    });

    redirect.addEventListener('click', () => {
      // ‡∏™‡πà‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤ Apps Script ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ù‡∏±‡∏á)
      window.location.replace(APP_URL);
    });

    // üîß ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ "‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö" ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Apps Script ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á
    // window.location.replace(APP_URL);
  </script>
</body>
</html>
